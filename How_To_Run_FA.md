# راهنمای نصب و راه‌اندازی سلف بات تلگرام

این راهنما به شما کمک می‌کند تا پروژه سلف بات تلگرام را به طور کامل و گام به گام نصب و راه‌اندازی کنید.

## فهرست مطالب

- [پیش‌نیازها](#پیش‌نیازها)
- [روش 1: نصب مستقیم](#روش-1-نصب-مستقیم)
- [روش 2: استفاده از داکر](#روش-2-استفاده-از-داکر)
- [تنظیمات اولیه](#تنظیمات-اولیه)
- [راه‌اندازی سلف بات](#راه‌اندازی-سلف-بات)
- [راه‌اندازی پنل وب](#راه‌اندازی-پنل-وب)
- [عیب‌یابی رایج](#عیب‌یابی-رایج)
- [سوالات متداول](#سوالات-متداول)

## پیش‌نیازها

قبل از شروع، باید اطمینان حاصل کنید که موارد زیر را روی سیستم خود نصب کرده‌اید:

### برای نصب مستقیم:

1. **پایتون 3.11 یا بالاتر**: [دانلود از سایت رسمی پایتون](https://www.python.org/downloads/)
   - در هنگام نصب، گزینه "Add Python to PATH" را فعال کنید.
   - برای بررسی نصب صحیح: `python --version` یا `python3 --version`

2. **PostgreSQL 15 یا بالاتر**: [دانلود PostgreSQL](https://www.postgresql.org/download/)
   - یک کاربر با دسترسی کامل ایجاد کنید.
   - یک دیتابیس به نام `selfbot` ایجاد کنید.

3. **Redis**: [دانلود Redis](https://redis.io/download)
   - برای ویندوز می‌توانید از [این لینک](https://github.com/tporadowski/redis/releases) استفاده کنید.

4. **اطلاعات API تلگرام**:
   - با مراجعه به [my.telegram.org](https://my.telegram.org) و ورود با حساب تلگرام خود
   - در قسمت API development tools، یک برنامه جدید ایجاد کنید
   - مقادیر `API_ID` و `API_HASH` را یادداشت کنید

### برای نصب با داکر:

1. **Docker**: [نصب Docker](https://docs.docker.com/get-docker/)
2. **Docker Compose**: معمولاً همراه با Docker نصب می‌شود، در غیر این صورت [آن را نصب کنید](https://docs.docker.com/compose/install/)
3. **اطلاعات API تلگرام** (مشابه بالا)

## روش 1: نصب مستقیم

### 1. دریافت پروژه

ابتدا پروژه را با استفاده از Git دریافت کنید:

```bash
git clone https://github.com/yourusername/telegram-selfbot.git
cd telegram-selfbot
```

اگر Git ندارید، می‌توانید فایل زیپ پروژه را دانلود و استخراج کنید.

### 2. ایجاد محیط مجازی پایتون

برای جلوگیری از تداخل با دیگر پروژه‌ها، ایجاد محیط مجازی پایتون توصیه می‌شود:

#### در ویندوز:

```powershell
python -m venv venv
.\venv\Scripts\activate
```

#### در لینوکس/مک:

```bash
python3 -m venv venv
source venv/bin/activate
```

### 3. نصب وابستگی‌ها

با استفاده از pip، تمام وابستگی‌های مورد نیاز را نصب کنید:

```bash
pip install -r requirements.txt
```

### 4. تنظیم فایل محیطی

فایل `.env.example` را به `.env` کپی کنید و سپس آن را با اطلاعات خود ویرایش کنید:

#### در ویندوز:

```powershell
copy .env.example .env
```

#### در لینوکس/مک:

```bash
cp .env.example .env
```

سپس فایل `.env` را با یک ویرایشگر متن باز کنید و مقادیر زیر را تنظیم کنید:

```
# تنظیمات دیتابیس
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres  # نام کاربری که هنگام نصب PostgreSQL ایجاد کردید
DB_PASSWORD=your_password  # رمز عبور دیتابیس
DB_NAME=selfbot

# تنظیمات Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # اگر Redis شما رمز دارد، آن را اینجا وارد کنید
REDIS_PREFIX=selfbot:

# تنظیمات تلگرام
TELEGRAM_API_ID=your_api_id  # API ID دریافتی از my.telegram.org
TELEGRAM_API_HASH=your_api_hash  # API Hash دریافتی از my.telegram.org
TELEGRAM_PHONE=+989123456789  # شماره تلفن همراه با کد کشور
TELEGRAM_SESSION_NAME=selfbot_session

# تنظیمات API
API_SECRET_KEY=your_secret_key_here_min_32_chars  # یک کلید تصادفی با حداقل 32 کاراکتر ایجاد کنید
API_TOKEN_EXPIRE_MINUTES=60
```

### 5. ایجاد و مهاجرت دیتابیس

ساختار دیتابیس را با اجرای اسکریپت‌های مهاجرت ایجاد کنید:

#### در ویندوز:

```powershell
python -m database.migration_manager migrate
```

#### در لینوکس/مک:

```bash
python -m database.migration_manager migrate
```

## روش 2: استفاده از داکر

### 1. دریافت پروژه

پروژه را با استفاده از Git دریافت کنید یا فایل زیپ آن را دانلود و استخراج کنید.

### 2. تنظیم فایل محیطی

فایل `.env.example` را به `.env` کپی کنید و آن را با اطلاعات خود ویرایش کنید. در حالت استفاده از داکر، نیازی به تغییر تنظیمات دیتابیس و Redis نیست، زیرا این سرویس‌ها به صورت خودکار راه‌اندازی می‌شوند. فقط اطلاعات API تلگرام خود را وارد کنید:

```
# تنظیمات تلگرام (این موارد را باید تغییر دهید)
TELEGRAM_API_ID=your_api_id
TELEGRAM_API_HASH=your_api_hash
TELEGRAM_PHONE=+989123456789
TELEGRAM_SESSION_NAME=selfbot_session

# تنظیمات API
API_SECRET_KEY=your_secret_key_here_min_32_chars  # یک کلید تصادفی ایجاد کنید
```

### 3. ساخت و اجرای کانتینرها

با استفاده از Docker Compose، کانتینرهای مورد نیاز را بسازید و اجرا کنید:

```bash
docker-compose up -d
```

این دستور تمام سرویس‌های مورد نیاز شامل سلف بات، API، پنل وب، PostgreSQL و Redis را راه‌اندازی می‌کند.

### 4. مشاهده لاگ‌ها

برای مشاهده لاگ‌های اجرا و اطمینان از راه‌اندازی صحیح:

```bash
docker-compose logs -f
```

## تنظیمات اولیه

### ورود به تلگرام

هنگامی که سلف بات را برای اولین بار اجرا می‌کنید، از شما درخواست می‌شود که به حساب تلگرام خود وارد شوید:

1. کد تأیید ارسال شده به تلگرام را وارد کنید
2. اگر حساب دارای رمز دو مرحله‌ای است، آن را نیز وارد کنید

اطلاعات جلسه در فایلی به نام `TELEGRAM_SESSION_NAME.session` (مطابق تنظیمات .env) ذخیره می‌شود.

### تنظیمات پیشرفته

برای تنظیمات پیشرفته‌تر می‌توانید فایل `config/app.json` را ویرایش کنید. این تنظیمات شامل:

- زبان پیش‌فرض
- تنظیمات پلاگین‌ها
- پیکربندی API و وب
- لیست ادمین‌ها

## راه‌اندازی سلف بات

### اجرای مستقیم (بدون داکر)

#### در ویندوز:

```powershell
# اگر از محیط مجازی استفاده می‌کنید، ابتدا آن را فعال کنید
.\venv\Scripts\activate
python main.py
```

#### در لینوکس/مک:

```bash
# اگر از محیط مجازی استفاده می‌کنید، ابتدا آن را فعال کنید
source venv/bin/activate
python main.py
```

### با استفاده از داکر

اگر از داکر استفاده می‌کنید، سلف بات به صورت خودکار با دستور `docker-compose up -d` اجرا می‌شود. برای راه‌اندازی مجدد:

```bash
docker-compose restart selfbot
```

## راه‌اندازی پنل وب

### نصب مستقیم

برای راه‌اندازی پنل وب، ابتدا باید پیش‌نیازهای آن را نصب کنید:

1. نصب Node.js (نسخه 16 یا بالاتر): [دانلود Node.js](https://nodejs.org/)
2. نصب وابستگی‌های پنل وب:

```bash
cd web
npm install
```

3. اجرای پنل وب در حالت توسعه:

```bash
npm run dev
```

یا ساخت نسخه نهایی:

```bash
npm run build
npm run start
```

### با استفاده از داکر

اگر از داکر استفاده می‌کنید، پنل وب به صورت خودکار در پورت 3000 راه‌اندازی می‌شود. می‌توانید با مراجعه به آدرس `http://localhost:3000` به آن دسترسی داشته باشید.

## عیب‌یابی رایج

### مشکلات اتصال به دیتابیس

- اطمینان حاصل کنید که PostgreSQL در حال اجرا است
- تنظیمات دیتابیس در فایل `.env` را بررسی کنید
- بررسی کنید کاربر دیتابیس دسترسی‌های لازم را داشته باشد

### مشکلات اتصال به Redis

- اطمینان حاصل کنید که Redis در حال اجرا است
- اگر Redis رمز عبور دارد، آن را در فایل `.env` تنظیم کنید

### مشکلات ورود به تلگرام

- بررسی کنید که `API_ID` و `API_HASH` در فایل `.env` به درستی تنظیم شده باشند
- اطمینان حاصل کنید که شماره تلفن با فرمت صحیح (با کد کشور) وارد شده باشد
- اگر پیام خطای "PHONE_CODE_INVALID" دریافت می‌کنید، کد تأیید را به دقت وارد کنید
- اگر از حساب شما محافظت دو مرحله‌ای فعال است، رمز عبور دو مرحله‌ای را نیز وارد کنید

### مشکلات نصب وابستگی‌ها

اگر در هنگام نصب وابستگی‌ها با خطا مواجه شدید، این مراحل را امتحان کنید:

```bash
# به‌روزرسانی pip
python -m pip install --upgrade pip

# نصب مجدد وابستگی‌ها
pip install -r requirements.txt
```

### مشکلات داکر

اگر با مشکلات داکر مواجه هستید:

```bash
# متوقف کردن و حذف کانتینرها
docker-compose down

# پاک کردن کش
docker system prune -a

# ساخت مجدد
docker-compose up -d --build
```

## سوالات متداول

### آیا می‌توانم چندین حساب تلگرام را همزمان مدیریت کنم؟
بله، برای هر حساب یک نمونه جداگانه از سلف بات راه‌اندازی کنید و مقدار `TELEGRAM_SESSION_NAME` را در فایل `.env` تغییر دهید.

### آیا سلف بات روی هاست‌های اشتراکی قابل اجراست؟
خیر، سلف بات نیاز به دسترسی به منابع سیستمی مانند دیتابیس و Redis دارد که معمولاً در هاست‌های اشتراکی محدود شده‌اند. استفاده از VPS یا سرویس‌های ابری توصیه می‌شود.

### آیا استفاده از سلف بات ایمن است؟
سلف بات با رمزنگاری کامل داده‌های حساس طراحی شده است، اما توصیه می‌شود همیشه از آن برای اهداف شخصی استفاده کنید و اطلاعات حساب خود را به اشتراک نگذارید.

### آیا سلف بات روی رسپبری پای قابل اجراست؟
بله، با نصب پیش‌نیازها و پیکربندی مناسب می‌توانید سلف بات را روی رسپبری پای اجرا کنید.

### سلف بات چقدر منابع سیستمی مصرف می‌کند؟
مصرف منابع به تعداد پلاگین‌های فعال و تعداد گفتگوها بستگی دارد. به طور میانگین، حداقل 512MB RAM و 1GB فضای دیسک نیاز است.
