# راهنمای تست‌های API

این بخش شامل تست‌های واحد و انتگریشن برای API های پروژه است. برای اجرای این تست‌ها باید وابستگی‌های مورد نیاز را نصب کنید.

## پکیج‌های مورد نیاز

برای اجرای تست‌ها، ابتدا باید پکیج‌های زیر را نصب کنید:

```bash
# نصب پکیج‌های اصلی تست
npm install --save-dev jest ts-jest @testing-library/jest-dom msw

# نصب تایپ‌های مورد نیاز
npm install --save-dev @types/jest
```

## ساختار تست‌ها

تست‌ها در پوشه‌های زیر سازماندهی شده‌اند:

- `/api`: تست‌های مربوط به API های پروژه
- `/components`: تست‌های مربوط به کامپوننت‌های React
- `/hooks`: تست‌های مربوط به هوک‌های سفارشی
- `/stores`: تست‌های مربوط به استورهای مدیریت حالت
- `/pages`: تست‌های مربوط به صفحات پروژه
- `/mocks`: فایل‌های شبیه‌سازی شده برای تست‌ها

## اجرای تست‌ها

برای اجرای تست‌ها می‌توانید از دستورات زیر استفاده کنید:

```bash
# اجرای همه تست‌ها
npm test

# اجرای تست‌ها در حالت watch
npm run test:watch

# اجرای تست‌ها با گزارش پوشش کد
npm run test:coverage
```

## نوشتن تست جدید

برای نوشتن تست جدید، می‌توانید از الگوهای موجود در پوشه‌های تست استفاده کنید. هر تست باید با پسوند `.test.ts` یا `.test.tsx` نامگذاری شود.

برای شبیه‌سازی API ها از کتابخانه MSW استفاده شده است. برای افزودن هندلر جدید، فایل `src/__tests__/mocks/handlers.ts` را ویرایش کنید.

## تنظیمات تست

تنظیمات اصلی تست در فایل‌های زیر قرار دارد:

- `jest.config.js`: تنظیمات اصلی Jest
- `src/__tests__/setupTests.ts`: تنظیمات مشترک برای همه تست‌ها

## ساختار یک تست نمونه

```typescript
/**
 * @jest-environment jsdom
 */

import { render, screen } from '@testing-library/react';
import { MyComponent } from '../path/to/component';

describe('MyComponent', () => {
  test('should render correctly', () => {
    render(<MyComponent />);
    
    expect(screen.getByText('Expected Text')).toBeInTheDocument();
  });
});
```

## نکات مهم

- تمام API ها باید تست شوند تا از صحت عملکرد آنها اطمینان حاصل شود.
- برای هر API باید حداقل تست‌های موفقیت و شکست نوشته شود.
- از MSW برای شبیه‌سازی پاسخ‌های سرور استفاده شود.
- در صورت نیاز به تغییر در API ها، ابتدا تست‌های مربوطه را بروزرسانی کنید.
